<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="utf-8">
    <title>問題解きなはれ</title>
    <style>
      .col {
      float: left;
      width: 256px;
      text-align: center;
      font-size: 128px;
      }
      .hoge {
      width: 512px;
      margin: 0px auto;
      }
    </style>
  </head>
  <body>
    <div class="hoge">
      <div class="col">
        <span id="num0">?</span><br>
        <input type="button" value="STOP" id="stop0">
      </div>
      <div class="col">
        <span id="num1">？？</span><br>
        <input type="button" value="STOP" id="stop1">
      </div>
    </div>
    <script>
      (function() {
      var timers, nums, probs = 5;

      document.getElementById('stop0').onclick = function() {
      stopSlot(0);
      };
      document.getElementById('stop1').onclick = function() {
      stopSlot(1);
      };

      function startSlot() {
      timers = [];
      nums = [];

      runSlot(0);
      runSlot(1);
      }

      function stopSlot(n) {
      if (typeof nums[n] !== 'undefined') {
      return;
      }
      clearTimeout(timers[n]);
      nums[n] = document.getElementById('num'+n).innerHTML;
      }

      function runSlot(n) {
      if (n == 0) {
      document.getElementById('num'+n).innerHTML = Math.floor(Math.random() * probs) + 1;
      } else {
      var names = ['斎藤', '堀田', '野添', '伊藤'];
      var i = Math.floor(Math.random() * 4);
      document.getElementById('num'+n).innerHTML = names[i];
      }
      timers[n] = setTimeout(function() {
      runSlot(n);
      }, 1);
      }

      startSlot();
      })();
    </script>
  </body>
</html>
